# CVE-2023-21554
[CVE-2023-21554](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21554), dubbed QueueJumper, is a remote code execution vulnerability in the Microsoft Message Queueing (MSMQ) service on Windows. MSMQ can be installed on any Windows machine, but is installed by default on Microsoft Exchange. 

# Overview
Diffing `mqqm.dll`  10.0.22621.963 and 10.0.22621.1555, it can be seen that there are quite a few functions that changed, and a few added functions. The ones that bring attention to the eyes:
##### Added:
- `GetNextSectionPtrSafe`
- `CEodHeader::GetNextSectionSafe` 
- `CPropertyHeader::GetNextSectionSafe`  
- `CSecurityHeader::GetNextSectionSafe`
- `CSoapSection::GetNextSectionSafe`  
- `CUserHeader::GetNextSectionSafe`  
##### Modified:
- `CUserHeader::SectionIsValid`
- `CDebugSection::SectionIsValid`
- `CBaseMqfHeader::SectionIsValid`
- `CXactHeader::SectionIsValid`
- `CPropertyHeader::SectionIsValid`
- `CMsgDeadletterHeader::SectionIsValid`
- `CMsgGroupHeader::SectionIsValid`
- `CSecurityHeader::SectionIsValid`

It becomes evident that there was an issue with the `GetNextSection` functions, indicated by the new `GetNextSectionSafe` functions on the header classes.

#TODO deep  dive example of one of the header `SectionIsValid` diffs.

#TODO explain how this is reachable.